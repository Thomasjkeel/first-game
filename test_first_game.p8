pico-8 cartridge // http://www.pico-8.com
version 16
__lua__

-- globals --
-- variables --
local player
local mandarin
local coin
local score
local mandarin_score

function _init()
 score=0
 mandarin_score=0
 player = {
  x=64,
  y=64,
  color=9,
  name="thomas",
  width=8,
  height=8,
  move_speed=2,
  alligned=false,
  mandarin_alligned=false,
  draw=function(self)
   spr(1, self.x, self.y)
   rect(self.x-1,self.y-1,self.x+self.width, self.y+self.height, 12)
   print(self.alligned,self.x+10, self.y, 7)
   -- print(self.name, self.x-7, self.y-7, 7)
  end,
  update=function(self)
   if btn(0) then
    self.x-=self.move_speed
   end
   if btn(1) then
    self.x+=self.move_speed
   end
   if btn(2) then
    self.y-=self.move_speed
   end
   if btn(3) then
    self.y+=self.move_speed
   end
   -- check hit detection
   local left=self.x
   local right=self.x+self.width
   local top=self.y
   local bottom=self.y+self.height
   if left<coin.x and coin.x<right and top<coin.y and coin.y<bottom then
    self.alligned=true
   else
    self.alligned=false
   end
   -- collect the coin
   if self.alligned and not coin.iscollected then
    coin.iscollected=true
    sfx(0)
    score+=1
   end
   -- mandarin hit detection
   if left<mandarin.x and mandarin.x<right and top<mandarin.y and mandarin.y<bottom then
    self.mandarin_alligned=true
   else
    self.mandarin_alligned=false
   end
   if self.mandarin_alligned and not mandarin.iscollected then
    mandarin.iscollected=true
    sfx(2)
    mandarin_score+=1
   end

  end
 }
 -- coin
 coin={
  x=flr(rnd(40))+64,
  y=flr(rnd(40))+64,
  iscollected=false,
  update=function(self)
  end,
  draw=function(self)
   if not self.iscollected then
    spr(3, self.x-3, self.y-4)
    pset(self.x,self.y,2)
   end
  end
 }
 -- mandarin
 mandarin={
  x=flr(rnd(40))+5,
  y=flr(rnd(40))+10,
  iscollected=false,
  update=function(self)
  end,
  draw=function(self)
   if not self.iscollected then
    spr(4, self.x-3, self.y-4)
    pset(self.x,self.y,10)
   end
  end
 }
end

function _update()
 player:update()
 coin:update()
 mandarin:update()
end

function _draw()
 cls(13)
 print("score: " .. score, 5, 5, 7)
 print("mandarins: " .. mandarin_score, 75, 5, 7)
 player:draw()
 coin:draw()
 mandarin:draw()
end


__gfx__
00000000099999000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000009ccc90000000000009aa000000b00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0070070009ccc9000000000009aaaa00004990000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00077000999999900000000009aaaa00049999000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0007700099999990000d000009aaaa00049999000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00700700099099000000000009aaaa00004990000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000009990999000000000009aa000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000999099900000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__map__
0000000000000000000000001412000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000020000000000020000001400020000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000040000000000020000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0002000000001400020004000000000200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__sfx__
000400002d0102f02033030350503906039070390203902001000290002c0000f1000c100141001a1002010025100291003310036100151001610000000000000000000000000000000000000000000000000000
000200000755007550075500755007550105500c550145500e5501355016550035000f500045000f5000450004500000000000000000000000000000000000000000000000000000000000000000000000000000
0008000010150101501e100171502110010150101502c100141502d100281501e000300002f000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
